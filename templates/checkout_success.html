{% load static %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Order Placed</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root {
      --accent: #f15aa8;
      --accent-dark: #d30640;
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      font-family: "Segoe UI", Arial, sans-serif;
      color: var(--accent-dark);
      background: linear-gradient(to right, #e83fb8, #f5f5dc);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .card {
      max-width: 880px;
      width: 100%;
      margin: 0 auto;
      padding: 28px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.96);
      box-shadow: 0 18px 50px rgba(0, 0, 0, 0.12);
      position: relative;
      z-index: 100;
      overflow: hidden;
    }

    h3 { color: var(--accent-dark); margin-bottom: 6px; }
    p.lead { margin-top: 4px; color: #6b2046; }

    .items-list { margin-top: 18px; }
    .items-list li {
      padding: 8px 0;
      border-bottom: 1px dashed #f5c0dc;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .items-list li:last-child { border-bottom: 0; }

    .badge-order {
      display: inline-block;
      background: linear-gradient(90deg, var(--accent), var(--accent-dark));
      color: white;
      padding: 6px 12px;
      border-radius: 999px;
      font-weight: 600;
      box-shadow: 0 6px 18px rgba(209, 6, 64, 0.12);
      margin-left: 8px;
    }

    .btn-primary {
      background-color: var(--accent);
      border: none;
      border-radius: 8px;
      padding: 10px 18px;
    }
    .btn-primary:hover { background-color: var(--accent-dark); }

    .meta {
      margin-top: 16px;
      color: #6b2046;
      font-size: 0.95rem;
    }

    .confetti-piece {
      position: fixed;
      z-index: 1100;
      pointer-events: none;
      font-size: 18px;
      will-change: transform, opacity;
      opacity: 0;
      transform: translateY(-10vh) rotate(0deg);
    }

    @media (max-width:768px){
      .card { padding: 20px; }
    }
  </style>
</head>
<body>
  <div class="card" role="region" aria-labelledby="order-title">
    <h3 id="order-title">Thank you â€” your order was placed!</h3>
    <p class="lead">Weâ€™ve received your order and will email confirmation shortly.</p>

    {% if order %}
      <div style="display:flex; align-items:center; gap:12px; margin-top:14px;">
        <div>
          <strong>Order for <span style="color:#7a0b45">{{ order.name }}</span></strong>
          <span class="badge-order">â‚¹{{ order.total }}</span>
        </div>
      </div>

      <p class="meta">A confirmation has been sent to <strong>{{ order.email }}</strong></p>

      <h5 style="margin-top:18px; color:var(--accent-dark)">Items</h5>
      <ul class="items-list">
        {% for it in order.items %}
          <li>
            <div style="display:flex; gap:12px; align-items:center;">
              {% if it.image_url %}
                <img src="{{ it.image_url }}" alt="{{ it.title }}" style="width:56px; height:40px; object-fit:cover; border-radius:6px; box-shadow:0 6px 18px rgba(0,0,0,0.06);">
              {% endif %}
              <div>
                <div style="font-weight:600;">{{ it.title }}</div>
                <div style="font-size:0.85rem; color:#7a0b45;">Qty: {{ it.qty }}</div>
              </div>
            </div>
            <div style="font-weight:600;">â‚¹{{ it.subtotal }}</div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>We've received your order. If you don't see a confirmation, contact support.</p>
    {% endif %}

    <div style="display:flex; gap:12px; margin-top:20px; align-items:center;">
       <a href="{% url 'invoice' order.id %}" class="btn btn-primary">Invoice</a>
      <a href="{% url 'homepage' %}" class="btn btn-primary">Continue Shopping</a>
      <a href="{% url 'homepage' %}" class="btn btn-primary">Contact Support</a>
    </div>
  </div>

  <script>
    // ðŸŽ‰ Confetti animation
    (function(){
      const emojis = ['ðŸŽ‰','âœ¨','ðŸŽŠ','ðŸ§§','ðŸ’«'];
      const pieces = 22;
      const duration = 4200;

      function rand(min,max){ return Math.random()*(max-min)+min; }

      function spawnConfetti(){
        for(let i=0;i<pieces;i++){
          const el = document.createElement('div');
          el.className = 'confetti-piece';
          el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
          document.body.appendChild(el);

          const startX = rand(5, 95);
          const rotate = rand(-360,360);
          const delay = rand(0, 800);
          el.style.left = startX + 'vw';
          el.style.top = '-6vh';
          el.style.opacity = '1';
          el.style.transform = `translateY(-10vh) rotate(${rotate}deg) scale(${rand(.85,1.25)})`;

          const fallDuration = duration + rand(-900,900);
          const endY = window.innerHeight + 60 + rand(0,200);
          const start = performance.now() + delay;

          (function animate(now){
            const t = Math.max(0, now - start);
            if (t >= 0) {
              const progress = Math.min(1, t / fallDuration);
              const eased = 1 - Math.pow(1 - progress, 3);
              el.style.transform = `translateY(${eased * endY}px) rotate(${rotate + eased*90}deg)`;
              el.style.opacity = (1 - eased).toString();
            }
            if (now < start + fallDuration) {
              requestAnimationFrame(animate);
            } else {
              el.remove();
            }
          })(performance.now());
        }
      }

      document.addEventListener('DOMContentLoaded', function(){
        spawnConfetti();
        setTimeout(spawnConfetti, 650);
      });
    })();
  </script>
</body>
</html>
